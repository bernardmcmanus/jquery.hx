/* ------------------------------------- */
/*         jQuery.hx v0.1 (beta)         */
/* ------------------------------------- */

(function(t){var n={debug:false};var r=function(e){this.element=e;this.props={};this.queue=[];this.listening=false;this.callback=function(){};var n=t(this.element);n.hxManager=1;t.extend(n,this);return n};r.prototype={handleEvent:function(e){this._transend(e)},set:function(e,r){var i=this;if(this.queue.indexOf(r.property)<0)this.queue.push(r.property);if(n.debug)console.log(this.queue);r={property:r.property,value:r.value,duration:r.duration||400,ease:r.ease||"cubic-bezier(0.25, 0.1, 0.25, 1)",delay:r.delay||1,done:r.done||[]};this.props[e]=r;if(n.debug)console.log(this.props);var s=this._buildTransitionString();if(n.debug)console.log(s);t(this.element).css("-webkit-transition",s);if(!this.listening){this.element.addEventListener("webkitTransitionEnd",this);this.listening=true}if(r.property==="-webkit-transform"){var o=this._buildTransformString()}else{var o=r.value}if(n.debug)console.log(o);setTimeout(function(){t(i.element).css(r.property,o)},this.props[e].delay)},_buildTransitionString:function(){var e=[];for(var t in this.props){var n=this.props[t].property+" "+this.props[t].ease+" "+this.props[t].duration;if(e.indexOf(n)<0)e.push(n)}return e.join(", ")},_buildTransformString:function(){var e=[];for(var t in this.props){if(this.props[t].property==="-webkit-transform")e.push(this.props[t].value)}return e.join(" ")},_isHXTransform:function(e){var t=["translate3d","scale3d","rotate3d","matrix","matrix3d"];var n=false;for(var r=0;r<t.length;r++){if(e.match(t[r]!=="matrix"?t[r]:t[r]+"\\(")){n=t[r];break}}return n},_parse:function(e){var t=this._isHXTransform(e);if(!e||!t)return{};e=e.replace(/px/g,"").replace(/ /g,"").replace(/\)/g,"").split("(")[1].split(",");var n=Array.prototype.map;e=n.call(e,function(e){return parseFloat(e,10)});return{type:t,transform:e}},_transend:function(e){var t=e.propertyName;for(var n in this.props){if(t===this.props[n].property&&this.props[n].done){for(var r=0;r<this.props[n].done.length;r++){this.props[n].done[r].call(this,e)}delete this.props[n].done}}var i=this.queue.indexOf(t);this.queue.splice(i,1);if(this.queue.length<1){if(this.callback)this.callback.call(this,e);this.element.removeEventListener("webkitTransitionEnd",this);this.listening=false}},done:function(e){this.callback=e||function(){}}};t.fn.hx=function(e,n){var i=this;if(!i.hxManager)i=new r(t(this).get(0));if(e)t.fn.hx[e].call(i,n);return i};t.fn.hx.scale=function(e){e=t.extend({duration:400,easing:"ease",delay:1,vector:{},done:function(){}},e);e.done=function(){};e.vector=t.extend({x:1,y:1,z:1},e.vector);try{this.set("scale3d",{property:"-webkit-transform",value:"scale3d("+e.vector.x+", "+e.vector.y+", "+e.vector.z+")",duration:e.duration+"ms",ease:e.ease,delay:e.delay,done:[e.done]})}catch(n){t(this).css({"-webkit-transition":"webkit-transform "+e.duration+"ms "+e.easing,"-webkit-transform":"translate3d("+e.vector.x+"px, "+e.vector.y+"px, "+e.vector.z+"px)"})}};t.fn.hx.translate=function(e){e=t.extend({duration:400,easing:"ease",delay:1,vector:{},done:function(){}},e);e.done=function(){};e.vector=t.extend({x:0,y:0,z:0},e.vector);try{this.set("translate3d",{property:"-webkit-transform",value:"translate3d("+e.vector.x+"px, "+e.vector.y+"px, "+e.vector.z+"px)",duration:e.duration+"ms",ease:e.ease,delay:e.delay,done:[e.done]})}catch(n){t(this).css({"-webkit-transition":"webkit-transform "+e.duration+"ms "+e.easing,"-webkit-transform":"translate3d("+e.vector.x+"px, "+e.vector.y+"px, "+e.vector.z+"px)"})}};t.fn.hx.fadeOut=function(e){e=t.extend({duration:400,easing:"ease",delay:1,done:function(){}},e);e.done=function(){};t(this).css({"-webkit-transition":"",opacity:1,display:"block"});var n=function(){t(this.element).css("display","none");this.set("opacity",{property:"opacity",value:1,duration:"0ms"})};try{this.set("opacity",{property:"opacity",value:0,duration:e.duration+"ms",ease:e.easing,delay:e.delay,done:[e.done,n]})}catch(r){t(this).css({"-webkit-transition":"opacity "+e.duration+"ms "+e.easing,opacity:0})}};t.fn.hx.fadeIn=function(e){e=t.extend({duration:400,easing:"ease",delay:1,done:function(){}},e);e.done=function(){};t(this).css({"-webkit-transition":"",opacity:0,display:"block"});try{this.set("opacity",{property:"opacity",value:1,duration:e.duration+"ms",ease:e.easing,delay:e.delay,done:[e.done]})}catch(n){t(this).css({"-webkit-transition":"opacity "+e.duration+"ms "+e.easing,opacity:1})}};t.fn.hx.notify=function(n){if(t(this).find(".hx_notify").length>0)return;var i=this;this.options=t.extend({message:"",timeout:1500,css:{},onOpen:function(){},onClose:function(){}},n||{});this.dims=t(this).get(0).getBoundingClientRect();this.Top=Math.round(this.dims.height*.4);this.Left=Math.round(this.dims.width*.1);this.Width=this.dims.width-this.Left*2;this.Height=Math.round(this.Width*.15);this.fontSize=Math.round(this.Height*.3);this.radius=Math.round(this.fontSize*.8);this.options.css=t.extend({"text-align":"center","font-size":this.fontSize+"px",color:"white",position:"absolute",left:this.Left+"px",top:this.Top+"px",width:this.Width+"px",height:this.Height+"px","line-height":this.Height+"px","background-color":"rgba(0,0,0,0.8)","-webkit-border-radius":this.radius+"px","z-index":1e4,display:"none"},this.options.css);var s=document.createElement("div");t(s).addClass("hx_notify").css(this.options.css).html(this.options.message).appendTo(t(this));this.overlay=new r(s);this.open=function(){this.overlay.hx("fadeIn",{duration:300}).hx("translate",{vector:{y:-this.Height},duration:300}).done(this.options.onOpen)};this.close=function(){this.overlay.hx("fadeOut",{duration:300}).hx("translate",{duration:300}).done(function(){i.options.onClose(e);t(i.overlay.element).remove()})};this.open();if(this.options.timeout>0){setTimeout(function(){i.close()},this.options.timeout)}}})(jQuery)