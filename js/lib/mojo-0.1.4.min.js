/*! MOJO - 0.1.4 - Bernard McManus - g1ffe1d - 2014-08-06 */
var _MOJO={},MOJO={};_MOJO.Shared=function(a,b){function c(a){return a.length}function d(b){return a.keys(b)}function e(a){return b.prototype.shift.call(a)}function f(a){return a instanceof b?a:a!==h?[a]:[]}function g(a,b){return{get:a,set:b,configurable:!0,enumerable:!1}}var h;return{length:c,keys:d,shift:e,ensureArray:f,descriptor:g}}(Object,Array),_MOJO.EventHandler=function(a){function b(a,b,d){var e=this;e.handler=a,e.context=b,e.active=!0,e.callback=function(){},e.args=c(d)}var c=a.ensureArray;return b.prototype={invoke:function(a,b){var d=this,e=d.handler;if(d.active&&!a.isBreak&&!a.shouldSkip(e)){var f=d.args.concat(c(b));f.unshift(a),e.apply(d.context,f),d.callback(a,e)}}},b}(_MOJO.Shared),_MOJO.Event=function(){function a(a,b){var d=this;d.isBreak=c,d.cancelBubble=c,d.defaultPrevented=c,d.skipHandlers=[],d.target=a,d.type=b,d.timeStamp=Date.now()}var b=!0,c=!1;return a.prototype={skip:function(a){this.skipHandlers.push(a)},shouldSkip:function(a){return this.skipHandlers.indexOf(a)>=0},"break":function(){this.isBreak=b},preventDefault:function(){this.defaultPrevented=b},stopPropagation:function(){this.cancelBubble=b}},a}(),_MOJO.When=function(a,b,c,d,e){function f(a,b){return m(a).map(function(a){return a.handler}).indexOf(b)}function g(a,c){(a instanceof b?a:a.split(" ")).forEach(c)}function h(a){return(a||{})[j]?a[j]:a}function i(a,b){return a===b?null:a}var j="handleMOJO",k=c.keys,l=c.shift,m=c.ensureArray,n=c.length;return{once:function(){var a=this,b=a.when.apply(a,arguments);b.forEach(function(a){a.callback=function(){this.active=!1}})},when:function(){var a=this,b=arguments,c=l(b),e=n(b)>1?l(b):e,f=[],j=l(b),k=h(j),m=i(j,k);return g(c,function(b,c){f.push(new d(k,m,e)),a._addHandler(b,f[c])}),f},happen:function(a,b){var c=this;a=c._ensureEType(a),g(a,function(a){var d=c._getHandlers(a,!0),f=new e(c,a);d.filter(function(a){return a.invoke(f,b),!a.active}).forEach(function(b){c._removeHandler(c._getHandlers(a),b.handler)})})},dispel:function(a,b){var c=this,d=c._getHandlers(),e=h(b);a=c._ensureEType(a),g(a,function(a){e?c._removeHandler(d[a],e):delete d[a]})},_ensureEType:function(a){return a||k(this._getHandlers()).join(" ")},_getHandlers:function(b,c){var d=this,e=d.handlers=d.handlers||{},f=b?e[b]=e[b]||[]:e;return c?b?f.slice():a.create(f):f},_addHandler:function(a,b){var c=this;c._getHandlers(a).push(b)},_removeHandler:function(a,b){var c=f(a,b);c>=0&&a.splice(c,1)}}}(Object,Array,_MOJO.Shared,_MOJO.EventHandler,_MOJO.Event),MOJO=function(a){function b(a){a=a||{};var c=this;b.Each(a,function(a,b){c[b]=a}),b.Construct(c)}var c=b.prototype=Object.create(a.When);return c.each=function(a){var c=this;b.Each(c,a,c.keys)},c.set=function(a,b){var c=this;return c[a]=b,c.happen("set",a),c[a]},c.remove=function(a){var b=this;delete b[a],b.happen("remove",a)},b}(_MOJO),MOJO.Each=function(a){function b(b,c,d){(d||a(b)).forEach(function(a,d){c(b[a],a,d)})}return b}(_MOJO.Shared.keys),MOJO.Create=function(a,b){function c(c){var d=a.create(b.prototype);return b.Each(c,function(a,b){d[b]=a}),d}return c}(Object,MOJO),MOJO.Construct=function(a,b){function c(b){var c={};a.defineProperties(b,{handlers:e(function(){return c}),keys:e(function(){return d(b)}),length:e(function(){return f(b.keys)}),handleMOJO:{value:(b.handleMOJO||function(){}).bind(b),configurable:!0,enumerable:!1}})}var d=b.keys,e=b.descriptor,f=b.length;return c}(Object,_MOJO.Shared),function(a){"object"==typeof exports?module.exports=a:window.MOJO=a}(MOJO);